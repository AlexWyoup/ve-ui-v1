<div class="widget-box nopadding">
	<div class="widget-title">
		<span class="icon"> <i class="icon-th-list"></i> </span>
		<h5>Manage Keys</h5>
	</div>
	<div class="widget-content" >
		<div class="row"  id="ssh_keys_page">
			<div class="col-md-12">
				<div class="col-md-4">
					<div class="cb_box">
						<h4 align="center" >Recent Activity</h4>
						<h5 align="Center"><span class="icon"> <i class="icon-calendar"></i> </span><b><%= @ssh_keys.last[:created_at] %></b></h5>
						<h5 align="Center"><%= link_to "#{@ssh_keys.last[:name]}", ssh_keys_path(:id => "1", :name => "name"), :remote => true, data: { spinlock: '#sshkey_current'} %> </h5>
					</div>
				</div>
				<div class="col-md-4">
					<br/>
					</br/>
					<%= link_to new_ssh_key_path, class: "btn btn-lg btn-success btn-block", :id => "popover_sshkey_new", :target => "_self" do %>
					<i class="icon-cloud">&nbsp;New Key</i>
					<% end %>
				</div>
				<div class="col-md-4">
					<br/>
					</br/>
					<%= link_to ssh_key_import_path, class: "btn btn-lg btn-success btn-block", :id => "popover_sshkey_import", :target => "_self" do %>
					<i class="icon-cloud-upload">&nbsp;Import Key</i>
					<% end %>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="widget-box nopadding">
	<div class="widget-title">
		<span class="icon"> <i class="icon-th"></i> </span>
		<h5>SSH Keys</h5>
	</div>
	<div class="widget-content nopadding">
		<% if @ssh_keys_collection.class != Megam::Error %>
		<table class="table table-bordered table-striped table-hover">
			<thead>
				<tr>
					<th>Actions</th>
					<th>Name</th>
					<th>Created At</th>
				</tr>
			</thead>
			<tbody>
				<% @ssh_keys.each do |sshkey| %>
				<tr>
					<td align="center"> <%= link_to   "#", :class => "btn btn-dark-blue" do %> <i class="icon-eye-open">&nbsp;View</i> <% end %>
					<%= link_to  sshkey_download_path(:filename => sshkey[:name]), :class => "btn btn-dark-blue" ,:remote => true, :target => "_self" do %> <i class="icon-cloud-download">&nbsp;Pub</i> <% end %>
					<%= link_to  sshkey_download_path(:filename => sshkey[:name]), :class => "btn btn-dark-red", :remote => true, :target => "_self" do %> <i class="icon-cloud-download">&nbsp;Private</i> <% end %> </td>
					<td align="center"><%= sshkey[:name] %></td>
					<td align="center"><span class="icon"> <i class="icon-calendar"></i> </span> <%= sshkey[:created_at] %></td>
				</tr>
				<% end %>
			</tbody>
		</table>
		<% end %>
	</div>
</div>

<div id="sshkey_postfinish_popup" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
					×
				</button>
				<h3 id="myModalLabel">SSH keys</h3>
			</div>
			<div class="modal-body">
				<div class="alert alert-success">
					<p>
						<div id="res_msg"></div>
						</br>
					</p>
				</div>
			</div>
			<div class="modal-footer">
				<%= link_to  "Ok", cloud_settings_path, :class => "btn btn-primary", :target => "_self" %>
			</div>
		</div>
	</div>
</div>

<div id="sshkey_postfinish_popup_error" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
					×
				</button>
				<h3 id="myModalLabel">SSH keys</h3>
			</div>
			<div class="modal-body">
				<div class="alert alert-error">

					<p>
						A SSH key creation request to the megam cloud gateway was not successful.
						</br>
						<div id="err_msg"></div>
					</p>
				</div>
			</div>
			<div class="modal-footer">
				<%= link_to  "Ok", cloud_settings_path, :class => "btn btn-primary", :target => "_self" %>
			</div>
		</div>
	</div>
</div>
