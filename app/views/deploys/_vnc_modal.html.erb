<!-- vnc form modal -->
<div class="modal fade" data-backdrop="static" id="vmvnc" tabindex="-1" role="basic" aria-hidden="true" >
    <div class="modal-dialog model-wide-body" >
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" id="vncclose"></button>
                <h4 class="modal-title">VNC</h4>
            </div>
            <div class="modal-body ">
                <input type="hidden" id="vncServerHost" name="server_host" value="<%= GlobalSetting.vnc_server_host %>">
                <input type="hidden" id="vncServerPort" name="server_port" value="<%= GlobalSetting.vnc_server_port %>">
                <input type="hidden" id="vncHost" name="host" value="<%= @deployed.get_vnchost %>">
                <input type="hidden" id="vncPort" name="port" value="<%= @deployed.get_vncport %>">
                <div id="screen-wrapper" style="display: none;">
                    <canvas id="screen"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    (function ($) {
      var canvas = document.getElementById('screen');
      var screen = new Screen(canvas);
      client = new Client(screen);

      $("#vncid").on('click', function(evt) {
        $('#vmvnc').modal('toggle');
        var serverURL = "ws://" + document.getElementById('vncServerHost').value;
        client.connect({
            host: document.getElementById('vncHost').value,
            port: parseInt(document.getElementById('vncPort').value, 10),
            //password: document.getElementById('password').value,
            password: "",
            url: serverURL
        }).then(function () {
            document.getElementById('screen-wrapper').style.display = 'block';
        });
      });

      $("#vncclose").on('click', function(evt) {
        $('#vmvnc').modal('toggle');
        client.disconnect();
      });

    })($);
</script>
